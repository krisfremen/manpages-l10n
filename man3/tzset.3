.\" Copyright 1993 David Metcalfe (david@prism.demon.co.uk)
.\"
.\" Permission is granted to make and distribute verbatim copies of this
.\" manual provided the copyright notice and this permission notice are
.\" preserved on all copies.
.\"
.\" Permission is granted to copy and distribute modified versions of this
.\" manual under the conditions for verbatim copying, provided that the
.\" entire resulting derived work is distributed under the terms of a
.\" permission notice identical to this one
.\" 
.\" Since the Linux kernel and libraries are constantly changing, this
.\" manual page may be incorrect or out-of-date.  The author(s) assume no
.\" responsibility for errors or omissions, or for damages resulting from
.\" the use of the information contained herein.  The author(s) may not
.\" have taken the same level of care in the production of this manual,
.\" which is licensed free of charge, as they might when working
.\" professionally.
.\" 
.\" Formatted or processed versions of this manual, if unaccompanied by
.\" the source, must acknowledge the copyright and authors of this work.
.\"
.\" References consulted:
.\"     Linux libc source code
.\"     Lewine's _POSIX Programmer's Guide_ (O'Reilly & Associates, 1991)
.\"     386BSD man pages
.\" Modified Sun Jul 25 11:01:58 1993 by Rik Faith (faith@cs.unc.edu)
.\" Modified 2001-11-13, aeb
.\" Translation into German by Walter Harms <walter.harms@informatik.uni-oldenburg.de>
.\"
.\"sync: man-pages 1.70
.\"
.TH TZSET 3 "13. November 2001" "" "Bibliotheksfunktionen"
.SH BEZEICHNUNG
tzset, tzname, timezone, daylight \- initialisiere Zeitzonen-Daten
.SH "ÜBERSICHT"
.B #include <time.h>
.sp
.B void tzset (void);
.sp
.BI "extern char *" tzname [2];
/* Zeitzonenname */
.br
.BI "extern long " timezone ;
/* Sommerzeit-Indikator */
.br
.BI "extern int " daylight ;
/* Abstand zu UTC */
.SH BESCHREIBUNG
Die Funktion
.B tzset
initialisiert
.BR tzname[] ,
.B daylight
und
.B timezone
abhängig
von der Umgebungsvariable
.IR TZ .
Diese Funktion wird automatisch von anderen Funktionen verwendet, die
Zeiten umrechnen und dazu Informationen zur Zeitzone benötigen.
In einer SysV-artigen Umgebung wird sie auch die Variablen
.I timezone
(Sekunden westlich von GMT) sowie
.I daylight
(0, falls diese Zeitzone keine Sommer-/Winterzeit-Regeln beinhaltet
und ungleich 0, falls es eine Zeit des Jahres gibt, in der
Sommer-/Winterzeit-Regeln greifen) setzen.

Sollte die TZ-Variable nicht gesetzt sein, wird
.I tzname
mit bestmöglicher
Näherung aus der lokal "Wall Clock"-Zeit gesetzt.  Dabei wird auf die Datei
.I localtime
im systemweiten Zeitzonen-Verzeichnis (siehe unten) zurückgegriffen,
dessen Format in
.BR tzfile (5)
beschrieben wird.  (Man sieht häufig auch
.I /etc/localtime
an dieser Stelle, ein Symlink zur richtigen Datei im Zeitzonen-Verzeichnis.)

Wenn die TZ-Variable gesetzt ist, jedoch ihr Wert NULL ist oder der Wert
ein Format (siehe unten) hat, welches nicht interpretiert werden kann, so
wird "Coordinated Universal Time" (UTC) benutzt.

Das Programm kennt drei verschiede Formate für TZ.  Das erste Format wird
benutzt wenn in der Zeitzone keine Sommerzeit vorgesehen ist.
.sp
.RS
.I std offset
.RE
.sp
Die Zeichenkette
.I std
definiert den Namen der Zeitzone.  Er besteht aus wenigstens
drei Buchstaben.  Die Zeichenkette
.I offset
folgt unmittelbar und beschreibt den Wert, der hinzuaddiert werden
muß, um Coordinated Universal Time (UTC) zu erhalten.  Der
.I offset
ist positiv für Zeitzonen westlich vom Null-Meridian (Greenwich) und
negativ für Zeitzonen östlich davon.  Die Stunde muss zwischen 0 und
24 liegen, 
die Minuten zwischen 0 und 59, die Sekunden ebenfalls.
(Nicht alle Systeme machen das so: AIX kennt auch HH >> 24 )

Das zweite Format ermöglicht es die Sommerzeit mit zu definieren.
.sp
.RS
.I std offset dst [offset],start[/time],end[/time]
.RE
.sp
Es sind keine Leerzeichen zwischen den Elementen vorgesehen.
Die ursprünglichen Werte für
.I std
und
.I offset
spezifizieren die Zeitzone wie oben beschrieben.  Die Zeichenketten
.I dst
und
.I offset
bezeichnen den Namen
und Offset der Sommerzeit.  Ist der Offset weggelassen wird angenommen,
daß die Sommerzeit eine Stunde in der Zukunft liegt.

Das Feld
.I start
definiert den Beginn der Sommerzeit und
.I end
bezeichnet das
Zurückschalten zur Normalzeit.  Die Felder können das folgende Format haben:
.sp
.TP
.RI J n
Dieses definiert einen Julianischen Tag, wobei
.I n
zwischen 1 und 365 liegt.
Der 29. Februar wird niemals gezählt, auch nicht in Schaltjahren.
.TP
.RI n
Dieses definiert einen Julianischen Tag, wobei
.I n
zwischen 1 und 365 liegt.
Der 29. Februar wird niemals gezählt, auch nicht in Schaltjahren.
.TP
.RI M m . w . d
Das definiert
.RS
   \- den Tag
.I d
.RI "(0 <= " d " <= 6)"
.RE
.RS
   \- der Woche
.I w
.RI "(1 <= " w " <= 5),"
in welcher der Tag
.I d
liegt,
.RE
.RS
   \- des Monats
.I m
.RI "(1 <= " m " <= 12)."

Woche 1 ist die erste Woche, in der der Tag
.I d
vorkommt und Woche 5 ist die letzte Woche, in der der Tag
.I d
vorkommt.  Tag 0 bezeichnet den Sonntag.
.RE
.TP
Die
.IR time \-Felder beschreiben den Zeitpunkt der jeweils lokalen Zeit,
an dem umgeschaltet wird.  Wenn hier
nicht anders definiert gilt die Voreinstellung 02:00:00.
.PP
Das dritte Format besagt, daß die Zeitzonen-Information aus einer Datei
gelesen werden soll.
.sp
.RS
:[filespec]
.RE
.sp
Wird hier keine Datei angegeben, so wird die Datei
.I localtime
im Verzeichnis für die Zeitzonendateien gelesen.
Die Zeitzonendateien finden sich im Verzeichnis
.IR /usr/share/zoneinfo .
Das Dateiformat ist in
.BR tzfile (5)
dokumentiert.  Sollte
.I filespec
nicht mit einem `/' beginnen, so wird der Pfad relativ zum Verzeichnis
für Zeitzonendateien angenommen.
.SH DATEIEN
Wo die Daten für die Zeitzonen gesucht werden, sind von der (g)libc Version
abhängig.  Libc4 und libc5 verwenden
.I /usr/lib/zoneinfo
und, wird seit libc-5.4.6
.I /usr/share/zoneinfo
probieren, wenn das fehlschlägt.
Seit Glibc2 gilt: wenn die Variable TZDIR existiert, wird sie als
Basisverzeichnis benutzt.  Die Voreinstellung hängt von der
Installation ab, bedeutet jedoch meistens
.IR /usr/share/zoneinfo .

Dieses Verzeichnis beinhaltet normalerweise folgende Dateien:
.TP
.I localtime 
 \- lokale Zeitzonendaten
.TP
.I posixrules
 \- Regeln für TZ nach POSIX
.PP
Häufig ist
.I /etc/localtime
ein Link auf die Datei
.I localtime oder auf die korrekte Zonendatei.
.SH "KONFORM ZU"
SVID 3, POSIX, BSD 4.3
.SH ANMERKUNGEN
Beachten Sie bitte, daß die Variable
.I daylight
nicht bedeutet, daß im Moment Sommerzeit herrscht.  Sie beschrieb
früher die Nummer eines Algorithmus (siehe Variable
.tz_dsttime
in
.BR gettimeofday (2)).
Sie ist seit mehreren Jahren obsolete, wird jedoch von SUSv2 vorausgesetzt.

BSD4.3 beinhaltete eine Routine
.BI "char *timezone(" zone , dst )\fR,
die den Namen der Zeitzone zurückgab, der dem ersten Argument (Minuten
westlich von GMT) entsprach.  Wenn das zweite Argument 0 war, wurde
der Standard-Name verwendet, andererseits die Sommerzeit-Version.
.SH SIEHE AUCH
.BR date (1),
.BR gettimeofday (2),
.BR time (2),
.BR ctime (3),
.BR getenv (3),
.BR tzfile (5).
 
